"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getResourcePathFromID = getResourcePathFromID;
exports.assembleResourceURL = assembleResourceURL;

var _path = _interopRequireDefault(require("path"));

var _url = _interopRequireWildcard(require("url"));

var _helpers = require("./helpers");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function getResourcePathFromID(id) {
  return `${(0, _helpers.isRelativePath)(id) ? ':' : ''}${id}`;
}

function assembleResourceURL(base, id, query) {
  const baseURL = typeof base === 'string' ? _url.default.parse(base) : base;

  const pathname = _path.default.join(baseURL.pathname, '/_', getResourcePathFromID(id));

  const search = query && new _url.URLSearchParams((0, _helpers.pickDefined)(query)).toString();
  return _url.default.format(_objectSpread({}, baseURL, {
    pathname,
    search
  }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9saWIvdXJsLWJ1aWxkZXIuanMiXSwibmFtZXMiOlsiZ2V0UmVzb3VyY2VQYXRoRnJvbUlEIiwiaWQiLCJhc3NlbWJsZVJlc291cmNlVVJMIiwiYmFzZSIsInF1ZXJ5IiwiYmFzZVVSTCIsIlVybCIsInBhcnNlIiwicGF0aG5hbWUiLCJQYXRoIiwiam9pbiIsInNlYXJjaCIsIlVSTFNlYXJjaFBhcmFtcyIsInRvU3RyaW5nIiwiZm9ybWF0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBOztBQUNBOztBQUVBOzs7Ozs7Ozs7O0FBRU8sU0FBU0EscUJBQVQsQ0FBK0JDLEVBQS9CLEVBQW1DO0FBQ3pDLFNBQVEsR0FBRSw2QkFBZUEsRUFBZixJQUFxQixHQUFyQixHQUEyQixFQUFHLEdBQUVBLEVBQUcsRUFBN0M7QUFDQTs7QUFFTSxTQUFTQyxtQkFBVCxDQUE2QkMsSUFBN0IsRUFBbUNGLEVBQW5DLEVBQXVDRyxLQUF2QyxFQUE4QztBQUNwRCxRQUFNQyxPQUFPLEdBQUcsT0FBT0YsSUFBUCxLQUFnQixRQUFoQixHQUEyQkcsYUFBSUMsS0FBSixDQUFVSixJQUFWLENBQTNCLEdBQTZDQSxJQUE3RDs7QUFDQSxRQUFNSyxRQUFRLEdBQUdDLGNBQUtDLElBQUwsQ0FBVUwsT0FBTyxDQUFDRyxRQUFsQixFQUE0QixJQUE1QixFQUFrQ1IscUJBQXFCLENBQUNDLEVBQUQsQ0FBdkQsQ0FBakI7O0FBQ0EsUUFBTVUsTUFBTSxHQUFHUCxLQUFLLElBQUksSUFBSVEsb0JBQUosQ0FBb0IsMEJBQVlSLEtBQVosQ0FBcEIsRUFBd0NTLFFBQXhDLEVBQXhCO0FBQ0EsU0FBT1AsYUFBSVEsTUFBSixtQkFBZ0JULE9BQWhCO0FBQXlCRyxJQUFBQSxRQUF6QjtBQUFtQ0csSUFBQUE7QUFBbkMsS0FBUDtBQUNBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgVXJsLCB7IFVSTFNlYXJjaFBhcmFtcyB9IGZyb20gJ3VybCc7XG5cbmltcG9ydCB7IGlzUmVsYXRpdmVQYXRoLCBwaWNrRGVmaW5lZCB9IGZyb20gJy4vaGVscGVycyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZXNvdXJjZVBhdGhGcm9tSUQoaWQpIHtcblx0cmV0dXJuIGAke2lzUmVsYXRpdmVQYXRoKGlkKSA/ICc6JyA6ICcnfSR7aWR9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VtYmxlUmVzb3VyY2VVUkwoYmFzZSwgaWQsIHF1ZXJ5KSB7XG5cdGNvbnN0IGJhc2VVUkwgPSB0eXBlb2YgYmFzZSA9PT0gJ3N0cmluZycgPyBVcmwucGFyc2UoYmFzZSkgOiBiYXNlO1xuXHRjb25zdCBwYXRobmFtZSA9IFBhdGguam9pbihiYXNlVVJMLnBhdGhuYW1lLCAnL18nLCBnZXRSZXNvdXJjZVBhdGhGcm9tSUQoaWQpKTtcblx0Y29uc3Qgc2VhcmNoID0gcXVlcnkgJiYgbmV3IFVSTFNlYXJjaFBhcmFtcyhwaWNrRGVmaW5lZChxdWVyeSkpLnRvU3RyaW5nKCk7XG5cdHJldHVybiBVcmwuZm9ybWF0KHsgLi4uYmFzZVVSTCwgcGF0aG5hbWUsIHNlYXJjaCB9KTtcbn1cbiJdfQ==