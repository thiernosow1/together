"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getDefaults;

var _noop = _interopRequireDefault(require("../helpers/noop"));

var _resolver = require("../resolver");

var _helpers = require("../helpers");

var _middleware = require("./middleware");

var _ = _interopRequireDefault(require("./"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function getDefaults(key) {
  switch (key) {
    case 'adapters':
      {
        const {
          CSSAdapter,
          LESSAdapter,
          SASSAdapter,
          JSONAdapter,
          ScriptAdapter
        } = _.default.adapters;
        return [{
          test: ctx => ctx.extension === '.css',
          adapter: CSSAdapter
        }, {
          test: ctx => ctx.extension === '.less',
          adapter: LESSAdapter
        }, {
          test: ctx => ctx.extension === '.sass' || ctx.extension === '.scss',
          adapter: SASSAdapter
        }, {
          test: ctx => ctx.extension === '.json',
          adapter: JSONAdapter
        }, {
          test: ctx => _resolver.defaultExtensions.includes(ctx.extension),
          adapter: ScriptAdapter
        }];
      }

    case 'babylon':
      return {
        sourceType: 'module',
        plugins: ['asyncGenerators', 'classProperties', 'dynamicImport', 'exportDefaultFrom', 'exportNamespaceFrom', 'jsx', 'objectRestSpread']
      };

    case 'optimize':
      return {
        constantFolding: (0, _noop.default)(),
        deadCode: true,
        unreferenced: true
      };

    case 'uglify':
      return {
        compress: {
          // https://github.com/mishoo/UglifyJS2/issues/2874
          inline: false
        },
        output: {
          comments: false
        }
      };

    default:
      return {
        root: '.',
        entry: '.',
        output: '.remote',
        config: '.modulerc',
        env: _.default.getEnv(),
        define: {
          'process.env.NODE_ENV': (0, _noop.default)(),
          'typeof process': 'object'
        },
        provide: {},
        optimize: getDefaults('optimize'),
        include: [],
        strict: false,
        core: _resolver.defaultCore,
        extensions: _resolver.defaultExtensions,
        mainFields: _resolver.defaultMainFields,
        moduleDirs: _resolver.defaultModuleDirs,
        outputTarget: 'module',
        babel: {
          envName: (0, _noop.default)()
        },
        babylon: getDefaults('babylon'),
        preset: undefined,
        uglify: (0, _noop.default)(),
        sourceMaps: (0, _noop.default)(),
        adapters: getDefaults('adapters'),
        middleware: [// Treat absolute URIs as external resources
        (0, _middleware.ExternalMiddleware)(ctx => (0, _helpers.isAbsoluteURL)(ctx.request)), // Treat data URIs as external resources
        (0, _middleware.ExternalMiddleware)(ctx => (0, _helpers.isDataURL)(ctx.request))],
        server: {
          port: 3000,
          uri: 'http://localhost:3000',
          static: [],
          redirects: (0, _noop.default)(),
          publicPath: (0, _noop.default)()
        },
        watch: false
      };
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9saWIvY29uZmlnLXN0b3JlL2RlZmF1bHRzLmpzIl0sIm5hbWVzIjpbImdldERlZmF1bHRzIiwia2V5IiwiQ1NTQWRhcHRlciIsIkxFU1NBZGFwdGVyIiwiU0FTU0FkYXB0ZXIiLCJKU09OQWRhcHRlciIsIlNjcmlwdEFkYXB0ZXIiLCJDb25maWdTdG9yZSIsImFkYXB0ZXJzIiwidGVzdCIsImN0eCIsImV4dGVuc2lvbiIsImFkYXB0ZXIiLCJkZWZhdWx0RXh0ZW5zaW9ucyIsImluY2x1ZGVzIiwic291cmNlVHlwZSIsInBsdWdpbnMiLCJjb25zdGFudEZvbGRpbmciLCJkZWFkQ29kZSIsInVucmVmZXJlbmNlZCIsImNvbXByZXNzIiwiaW5saW5lIiwib3V0cHV0IiwiY29tbWVudHMiLCJyb290IiwiZW50cnkiLCJjb25maWciLCJlbnYiLCJnZXRFbnYiLCJkZWZpbmUiLCJwcm92aWRlIiwib3B0aW1pemUiLCJpbmNsdWRlIiwic3RyaWN0IiwiY29yZSIsImRlZmF1bHRDb3JlIiwiZXh0ZW5zaW9ucyIsIm1haW5GaWVsZHMiLCJkZWZhdWx0TWFpbkZpZWxkcyIsIm1vZHVsZURpcnMiLCJkZWZhdWx0TW9kdWxlRGlycyIsIm91dHB1dFRhcmdldCIsImJhYmVsIiwiZW52TmFtZSIsImJhYnlsb24iLCJwcmVzZXQiLCJ1bmRlZmluZWQiLCJ1Z2xpZnkiLCJzb3VyY2VNYXBzIiwibWlkZGxld2FyZSIsInJlcXVlc3QiLCJzZXJ2ZXIiLCJwb3J0IiwidXJpIiwic3RhdGljIiwicmVkaXJlY3RzIiwicHVibGljUGF0aCIsIndhdGNoIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFFZSxTQUFTQSxXQUFULENBQXFCQyxHQUFyQixFQUEwQjtBQUN4QyxVQUFRQSxHQUFSO0FBQ0MsU0FBSyxVQUFMO0FBQWlCO0FBQ2hCLGNBQU07QUFDTEMsVUFBQUEsVUFESztBQUVMQyxVQUFBQSxXQUZLO0FB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O0FBMkJOaUQsUUFBQUEsVUFBVSxFQUFFLENBQ1g7QUFDQSw0Q0FBbUJ2QyxHQUFHLElBQUksNEJBQWNBLEdBQUcsQ0FBQ3dDLE9BQWxCLENBQTFCLENBRlcsRUFHWDtBQUNBLDRDQUFtQnhDLEdBQUcsSUFBSSx3QkFBVUEsR0FBRyxDQUFDd0MsT0FBZCxDQUExQixDQUpXLENBM0JOO0FBaUNOQyxRQUFBQSxNQUFNLEVBQUU7QUFDUEMsVUFBQUEsSUFBSSxFQUFFLElBREM7QUFFUEMsVUFBQUEsR0FBRyxFQUFFLHVCQUZFO0FBR1BDLFVBQUFBLE1BQU0sRUFBRSxFQUhEO0FBSVBDLFVBQUFBLFNBQVMsRUFBRSxvQkFKSjtBQUtQQyxVQUFBQSxVQUFVLEVBQUU7QUFMTCxTQWpDRjtBQXdDTkMsUUFBQUEsS0FBSyxFQUFFO0FBeENELE9BQVA7QUE5REY7QUF5R0EiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbm9vcCBmcm9tICcuLi9oZWxwZXJzL25vb3AnO1xuXG5pbXBvcnQgeyBkZWZhdWx0Q29yZSwgZGVmYXVsdEV4dGVuc2lvbnMsIGRlZmF1bHRNYWluRmllbGRzLCBkZWZhdWx0TW9kdWxlRGlycyB9IGZyb20gJy4uL3Jlc29sdmVyJztcbmltcG9ydCB7IGlzQWJzb2x1dGVVUkwsIGlzRGF0YVVSTCB9IGZyb20gJy4uL2hlbHBlcnMnO1xuaW1wb3J0IHsgRXh0ZXJuYWxNaWRkbGV3YXJlIH0gZnJvbSAnLi9taWRkbGV3YXJlJztcbmltcG9ydCBDb25maWdTdG9yZSBmcm9tICcuLyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldERlZmF1bHRzKGtleSkge1xuXHRzd2l0Y2ggKGtleSkge1xuXHRcdGNhc2UgJ2FkYXB0ZXJzJzoge1xuXHRcdFx0Y29uc3Qge1xuXHRcdFx0XHRDU1NBZGFwdGVyLFxuXHRcdFx0XHRMRVNTQWRhcHRlcixcblx0XHRcdFx0U0FTU0FkYXB0ZXIsXG5cdFx0XHRcdEpTT05BZGFwdGVyLFxuXHRcdFx0XHRTY3JpcHRBZGFwdGVyXG5cdFx0XHR9ID0gQ29uZmlnU3RvcmUuYWRhcHRlcnM7XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dGVzdDogY3R4ID0+IGN0eC5leHRlbnNpb24gPT09ICcuY3NzJyxcblx0XHRcdFx0XHRhZGFwdGVyOiBDU1NBZGFwdGVyXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0ZXN0OiBjdHggPT4gY3R4LmV4dGVuc2lvbiA9PT0gJy5sZXNzJyxcblx0XHRcdFx0XHRhZGFwdGVyOiBMRVNTQWRhcHRlclxuXHRcdFx0XHR9LFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dGVzdDogY3R4ID0+IGN0eC5leHRlbnNpb24gPT09ICcuc2FzcycgfHwgY3R4LmV4dGVuc2lvbiA9PT0gJy5zY3NzJyxcblx0XHRcdFx0XHRhZGFwdGVyOiBTQVNTQWRhcHRlclxuXHRcdFx0XHR9LFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dGVzdDogY3R4ID0+IGN0eC5leHRlbnNpb24gPT09ICcuanNvbicsXG5cdFx0XHRcdFx0YWRhcHRlcjogSlNPTkFkYXB0ZXJcblx0XHRcdFx0fSxcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHRlc3Q6IGN0eCA9PiBkZWZhdWx0RXh0ZW5zaW9ucy5pbmNsdWRlcyhjdHguZXh0ZW5zaW9uKSxcblx0XHRcdFx0XHRhZGFwdGVyOiBTY3JpcHRBZGFwdGVyXG5cdFx0XHRcdH1cblx0XHRcdF07XG5cdFx0fVxuXHRcdGNhc2UgJ2JhYnlsb24nOlxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0c291cmNlVHlwZTogJ21vZHVsZScsXG5cdFx0XHRcdHBsdWdpbnM6IFtcblx0XHRcdFx0XHQnYXN5bmNHZW5lcmF0b3JzJyxcblx0XHRcdFx0XHQnY2xhc3NQcm9wZXJ0aWVzJyxcblx0XHRcdFx0XHQnZHluYW1pY0ltcG9ydCcsXG5cdFx0XHRcdFx0J2V4cG9ydERlZmF1bHRGcm9tJyxcblx0XHRcdFx0XHQnZXhwb3J0TmFtZXNwYWNlRnJvbScsXG5cdFx0XHRcdFx0J2pzeCcsXG5cdFx0XHRcdFx0J29iamVjdFJlc3RTcHJlYWQnXG5cdFx0XHRcdF1cblx0XHRcdH07XG5cdFx0Y2FzZSAnb3B0aW1pemUnOlxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0Y29uc3RhbnRGb2xkaW5nOiBub29wKC8qIGNhbGN1bGF0ZWQgKi8pLFxuXHRcdFx0XHRkZWFkQ29kZTogdHJ1ZSxcblx0XHRcdFx0dW5yZWZlcmVuY2VkOiB0cnVlXG5cdFx0XHR9O1xuXHRcdGNhc2UgJ3VnbGlmeSc6XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRjb21wcmVzczoge1xuXHRcdFx0XHRcdC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9taXNob28vVWdsaWZ5SlMyL2lzc3Vlcy8yODc0XG5cdFx0XHRcdFx0aW5saW5lOiBmYWxzZVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRvdXRwdXQ6IHtcblx0XHRcdFx0XHRjb21tZW50czogZmFsc2Vcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRkZWZhdWx0OlxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0cm9vdDogJy4nLFxuXHRcdFx0XHRlbnRyeTogJy4nLFxuXHRcdFx0XHRvdXRwdXQ6ICcucmVtb3RlJyxcblx0XHRcdFx0Y29uZmlnOiAnLm1vZHVsZXJjJyxcblx0XHRcdFx0ZW52OiBDb25maWdTdG9yZS5nZXRFbnYoKSxcblx0XHRcdFx0ZGVmaW5lOiB7XG5cdFx0XHRcdFx0J3Byb2Nlc3MuZW52Lk5PREVfRU5WJzogbm9vcCgvKiBjYWxjdWxhdGVkICovKSxcblx0XHRcdFx0XHQndHlwZW9mIHByb2Nlc3MnOiAnb2JqZWN0J1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRwcm92aWRlOiB7fSxcblx0XHRcdFx0b3B0aW1pemU6IGdldERlZmF1bHRzKCdvcHRpbWl6ZScpLFxuXHRcdFx0XHRpbmNsdWRlOiBbXSxcblx0XHRcdFx0c3RyaWN0OiBmYWxzZSxcblx0XHRcdFx0Y29yZTogZGVmYXVsdENvcmUsXG5cdFx0XHRcdGV4dGVuc2lvbnM6IGRlZmF1bHRFeHRlbnNpb25zLFxuXHRcdFx0XHRtYWluRmllbGRzOiBkZWZhdWx0TWFpbkZpZWxkcyxcblx0XHRcdFx0bW9kdWxlRGlyczogZGVmYXVsdE1vZHVsZURpcnMsXG5cdFx0XHRcdG91dHB1dFRhcmdldDogJ21vZHVsZScsXG5cdFx0XHRcdGJhYmVsOiB7XG5cdFx0XHRcdFx0ZW52TmFtZTogbm9vcCgvKiBjYWxjdWxhdGVkICovKVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRiYWJ5bG9uOiBnZXREZWZhdWx0cygnYmFieWxvbicpLFxuXHRcdFx0XHRwcmVzZXQ6IHVuZGVmaW5lZCxcblx0XHRcdFx0dWdsaWZ5OiBub29wKC8qIGNhbGN1bGF0ZWQgKi8pLFxuXHRcdFx0XHRzb3VyY2VNYXBzOiBub29wKC8qIGNhbGN1bGF0ZWQgKi8pLFxuXHRcdFx0XHRhZGFwdGVyczogZ2V0RGVmYXVsdHMoJ2FkYXB0ZXJzJyksXG5cdFx0XHRcdG1pZGRsZXdhcmU6IFtcblx0XHRcdFx0XHQvLyBUcmVhdCBhYnNvbHV0ZSBVUklzIGFzIGV4dGVybmFsIHJlc291cmNlc1xuXHRcdFx0XHRcdEV4dGVybmFsTWlkZGxld2FyZShjdHggPT4gaXNBYnNvbHV0ZVVSTChjdHgucmVxdWVzdCkpLFxuXHRcdFx0XHRcdC8vIFRyZWF0IGRhdGEgVVJJcyBhcyBleHRlcm5hbCByZXNvdXJjZXNcblx0XHRcdFx0XHRFeHRlcm5hbE1pZGRsZXdhcmUoY3R4ID0+IGlzRGF0YVVSTChjdHgucmVxdWVzdCkpXG5cdFx0XHRcdF0sXG5cdFx0XHRcdHNlcnZlcjoge1xuXHRcdFx0XHRcdHBvcnQ6IDMwMDAsXG5cdFx0XHRcdFx0dXJpOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwJyxcblx0XHRcdFx0XHRzdGF0aWM6IFtdLFxuXHRcdFx0XHRcdHJlZGlyZWN0czogbm9vcCgvKiBjYWxjdWxhdGVkICovKSxcblx0XHRcdFx0XHRwdWJsaWNQYXRoOiBub29wKC8qIGNhbGN1bGF0ZWQgKi8pXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHdhdGNoOiBmYWxzZVxuXHRcdFx0fTtcblx0fVxufVxuIl19